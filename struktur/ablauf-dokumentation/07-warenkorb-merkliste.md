# 07 - Warenkorb und Merkliste

> **Szenario:** Ein Benutzer fÃ¼gt BÃ¼cher zum Warenkorb oder zur Merkliste hinzu, ohne eingeloggt zu sein.

---

## âš¡ Besonderheit: Rein Frontend-basiert

**Dieser Flow hat KEINE Backend-Kommunikation!**

- Warenkorb und Merkliste werden komplett im Browser gespeichert
- Verwendung von `localStorage` fÃ¼r Persistenz
- Kein Login erforderlich
- Daten bleiben auch nach Browser-Neustart erhalten

---

## ğŸ”„ Ablauf-Diagramm: Zum Warenkorb hinzufÃ¼gen

```text
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1. AUSGANGSPUNKT: Detailseite eines Buchs                                            â”‚
â”‚                                                                                      â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚    â”‚  â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—  â”‚  â”‚
â”‚    â”‚  â•‘  ğŸ“˜ Angular Masterclass                                               â•‘  â”‚  â”‚
â”‚    â”‚  â•‘  Von AnfÃ¤nger zum Profi                                               â•‘  â”‚  â”‚
â”‚    â”‚  â•‘                                                                       â•‘  â”‚  â”‚
â”‚    â”‚  â•‘  Preis: â‚¬39.95                                                        â•‘  â”‚  â”‚
â”‚    â”‚  â•‘  Rating: â˜…â˜…â˜…â˜…â˜…                                                        â•‘  â”‚  â”‚
â”‚    â”‚  â•‘                                                                       â•‘  â”‚  â”‚
â”‚    â”‚  â•‘  [ğŸ›’ In den Warenkorb]  [â¤ï¸ Auf Merkliste]                            â•‘  â”‚  â”‚
â”‚    â”‚  â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•  â”‚  â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                        â”‚
                                        â–¼ User klickt "In den Warenkorb"
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 2. DETAIL-COMPONENT: Event-Handler                                                   â”‚
â”‚                                                                                      â”‚
â”‚    detail.component.ts:                                                              â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚    â”‚ addToCart(): void {                                                          â”‚  â”‚
â”‚    â”‚     if (!this.buch) return;                                                  â”‚  â”‚
â”‚    â”‚                                                                              â”‚  â”‚
â”‚    â”‚     this.cartService.addToCart(this.buch);                                   â”‚  â”‚
â”‚    â”‚                                                                              â”‚  â”‚
â”‚    â”‚     // Feedback fÃ¼r User                                                     â”‚  â”‚
â”‚    â”‚     this.showToast('Zum Warenkorb hinzugefÃ¼gt! ğŸ›’');                         â”‚  â”‚
â”‚    â”‚ }                                                                            â”‚  â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                        â”‚
                                        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 3. CART-SERVICE: Buch zum Warenkorb hinzufÃ¼gen                                       â”‚
â”‚                                                                                      â”‚
â”‚    cart.service.ts:                                                                  â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚    â”‚ @Injectable({ providedIn: 'root' })                                          â”‚  â”‚
â”‚    â”‚ export class CartService {                                                   â”‚  â”‚
â”‚    â”‚     private readonly STORAGE_KEY = 'bookshop_cart';                          â”‚  â”‚
â”‚    â”‚                                                                              â”‚  â”‚
â”‚    â”‚     // BehaviorSubject fÃ¼r reaktive Updates                                  â”‚  â”‚
â”‚    â”‚     private cartItems$ = new BehaviorSubject<CartItem[]>(                    â”‚  â”‚
â”‚    â”‚         this.loadFromStorage()                                               â”‚  â”‚
â”‚    â”‚     );                                                                       â”‚  â”‚
â”‚    â”‚                                                                              â”‚  â”‚
â”‚    â”‚     addToCart(buch: Buch): void {                                            â”‚  â”‚
â”‚    â”‚         const current = this.cartItems$.getValue();                          â”‚  â”‚
â”‚    â”‚                                                                              â”‚  â”‚
â”‚    â”‚         // PrÃ¼fen ob Buch bereits im Warenkorb                               â”‚  â”‚
â”‚    â”‚         const existing = current.find(item => item.buch.id === buch.id);     â”‚  â”‚
â”‚    â”‚         if (existing) {                                                      â”‚  â”‚
â”‚    â”‚             existing.quantity++;  // Menge erhÃ¶hen                           â”‚  â”‚
â”‚    â”‚         } else {                                                             â”‚  â”‚
â”‚    â”‚             current.push({ buch, quantity: 1 });  // Neu hinzufÃ¼gen          â”‚  â”‚
â”‚    â”‚         }                                                                    â”‚  â”‚
â”‚    â”‚                                                                              â”‚  â”‚
â”‚    â”‚         // In localStorage speichern                                         â”‚  â”‚
â”‚    â”‚         this.saveToStorage(current);                                         â”‚  â”‚
â”‚    â”‚                                                                              â”‚  â”‚
â”‚    â”‚         // Alle Subscriber benachrichtigen                                   â”‚  â”‚
â”‚    â”‚         this.cartItems$.next(current);                                       â”‚  â”‚
â”‚    â”‚     }                                                                        â”‚  â”‚
â”‚    â”‚ }                                                                            â”‚  â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                        â”‚
                                        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 4. LOCAL-STORAGE: Daten persistieren                                                 â”‚
â”‚                                                                                      â”‚
â”‚    cart.service.ts:                                                                  â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚    â”‚ private saveToStorage(items: CartItem[]): void {                             â”‚  â”‚
â”‚    â”‚     // Nur relevante Daten speichern (nicht das ganze Buch-Objekt)           â”‚  â”‚
â”‚    â”‚     const toStore = items.map(item => ({                                     â”‚  â”‚
â”‚    â”‚         buchId: item.buch.id,                                                â”‚  â”‚
â”‚    â”‚         titel: item.buch.titel?.titel,                                       â”‚  â”‚
â”‚    â”‚         preis: item.buch.preis,                                              â”‚  â”‚
â”‚    â”‚         quantity: item.quantity                                              â”‚  â”‚
â”‚    â”‚     }));                                                                     â”‚  â”‚
â”‚    â”‚                                                                              â”‚  â”‚
â”‚    â”‚     localStorage.setItem(                                                    â”‚  â”‚
â”‚    â”‚         this.STORAGE_KEY,                                                    â”‚  â”‚
â”‚    â”‚         JSON.stringify(toStore)                                              â”‚  â”‚
â”‚    â”‚     );                                                                       â”‚  â”‚
â”‚    â”‚ }                                                                            â”‚  â”‚
â”‚    â”‚                                                                              â”‚  â”‚
â”‚    â”‚ private loadFromStorage(): CartItem[] {                                      â”‚  â”‚
â”‚    â”‚     const stored = localStorage.getItem(this.STORAGE_KEY);                   â”‚  â”‚
â”‚    â”‚     if (!stored) return [];                                                  â”‚  â”‚
â”‚    â”‚                                                                              â”‚  â”‚
â”‚    â”‚     try {                                                                    â”‚  â”‚
â”‚    â”‚         return JSON.parse(stored);                                           â”‚  â”‚
â”‚    â”‚     } catch {                                                                â”‚  â”‚
â”‚    â”‚         return [];                                                           â”‚  â”‚
â”‚    â”‚     }                                                                        â”‚  â”‚
â”‚    â”‚ }                                                                            â”‚  â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                                      â”‚
â”‚    localStorage Inhalt:                                                              â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚    â”‚ Key: "bookshop_cart"                                                         â”‚  â”‚
â”‚    â”‚ Value: [                                                                     â”‚  â”‚
â”‚    â”‚     {                                                                        â”‚  â”‚
â”‚    â”‚         "buchId": 1,                                                         â”‚  â”‚
â”‚    â”‚         "titel": "Angular Masterclass",                                      â”‚  â”‚
â”‚    â”‚         "preis": 39.95,                                                      â”‚  â”‚
â”‚    â”‚         "quantity": 1                                                        â”‚  â”‚
â”‚    â”‚     }                                                                        â”‚  â”‚
â”‚    â”‚ ]                                                                            â”‚  â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                        â”‚
                                        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 5. NAVBAR: Warenkorb-Badge aktualisieren                                             â”‚
â”‚                                                                                      â”‚
â”‚    navbar.component.ts:                                                              â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚    â”‚ // Im Template (oder als Computed Signal)                                    â”‚  â”‚
â”‚    â”‚ cartCount$ = this.cartService.getItemCount();                                â”‚  â”‚
â”‚    â”‚                                                                              â”‚  â”‚
â”‚    â”‚ // Template:                                                                 â”‚  â”‚
â”‚    â”‚ <a routerLink="/cart" class="nav-link">                                      â”‚  â”‚
â”‚    â”‚     ğŸ›’ Warenkorb                                                             â”‚  â”‚
â”‚    â”‚     <span *ngIf="cartCount$ | async as count"                                â”‚  â”‚
â”‚    â”‚           class="badge bg-danger">                                           â”‚  â”‚
â”‚    â”‚         {{ count }}                                                          â”‚  â”‚
â”‚    â”‚     </span>                                                                  â”‚  â”‚
â”‚    â”‚ </a>                                                                         â”‚  â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                                      â”‚
â”‚    Visuelles Ergebnis:                                                               â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚    â”‚   [Home] [Suche] [Anlegen]                   ğŸ›’ Warenkorb (1)  [Login]       â”‚  â”‚
â”‚    â”‚                                                      â–²                       â”‚  â”‚
â”‚    â”‚                                            Badge zeigt Anzahl                â”‚  â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”„ Ablauf-Diagramm: Merkliste

```text
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ MERKLISTE: Gleicher Flow wie Warenkorb                                               â”‚
â”‚                                                                                      â”‚
â”‚    wishlist.service.ts:                                                              â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚    â”‚ @Injectable({ providedIn: 'root' })                                          â”‚  â”‚
â”‚    â”‚ export class WishlistService {                                               â”‚  â”‚
â”‚    â”‚     private readonly STORAGE_KEY = 'bookshop_wishlist';                      â”‚  â”‚
â”‚    â”‚                                                                              â”‚  â”‚
â”‚    â”‚     // Nur Buch-IDs speichern (keine Mengen)                                 â”‚  â”‚
â”‚    â”‚     private wishlistIds$ = new BehaviorSubject<number[]>(                    â”‚  â”‚
â”‚    â”‚         this.loadFromStorage()                                               â”‚  â”‚
â”‚    â”‚     );                                                                       â”‚  â”‚
â”‚    â”‚                                                                              â”‚  â”‚
â”‚    â”‚     toggleWishlist(buchId: number): void {                                   â”‚  â”‚
â”‚    â”‚         const current = this.wishlistIds$.getValue();                        â”‚  â”‚
â”‚    â”‚         const index = current.indexOf(buchId);                               â”‚  â”‚
â”‚    â”‚                                                                              â”‚  â”‚
â”‚    â”‚         if (index > -1) {                                                    â”‚  â”‚
â”‚    â”‚             current.splice(index, 1);  // Entfernen                          â”‚  â”‚
â”‚    â”‚         } else {                                                             â”‚  â”‚
â”‚    â”‚             current.push(buchId);  // HinzufÃ¼gen                             â”‚  â”‚
â”‚    â”‚         }                                                                    â”‚  â”‚
â”‚    â”‚                                                                              â”‚  â”‚
â”‚    â”‚         this.saveToStorage(current);                                         â”‚  â”‚
â”‚    â”‚         this.wishlistIds$.next([...current]);                                â”‚  â”‚
â”‚    â”‚     }                                                                        â”‚  â”‚
â”‚    â”‚                                                                              â”‚  â”‚
â”‚    â”‚     isInWishlist(buchId: number): Observable<boolean> {                      â”‚  â”‚
â”‚    â”‚         return this.wishlistIds$.pipe(                                       â”‚  â”‚
â”‚    â”‚             map(ids => ids.includes(buchId))                                 â”‚  â”‚
â”‚    â”‚         );                                                                   â”‚  â”‚
â”‚    â”‚     }                                                                        â”‚  â”‚
â”‚    â”‚ }                                                                            â”‚  â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                                      â”‚
â”‚    Unterschied zum Warenkorb:                                                        â”‚
â”‚    - Kein "quantity" (ein Buch kann nur einmal auf der Liste sein)                   â”‚
â”‚    - Toggle-Funktion (erneut klicken = entfernen)                                    â”‚  â”‚
â”‚    - Herz-Icon Ã¤ndert sich: â™¡ â†’ â¤ï¸                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“ Beteiligte Dateien

| Datei                                                           | Rolle                                    |
| --------------------------------------------------------------- | ---------------------------------------- |
| `frontend/src/app/features/buch/cart/cart.service.ts`           | Warenkorb-Logik, localStorage            |
| `frontend/src/app/features/buch/wishlist/wishlist.service.ts`   | Merkliste-Logik, localStorage            |
| `frontend/src/app/features/buch/pages/detail.component.ts`      | Buttons "In Warenkorb" / "Auf Merkliste" |
| `frontend/src/app/app.component.ts`                             | Badge mit Anzahl (im Header)             |
| `frontend/src/app/features/buch/cart/cart.component.ts`         | Warenkorb-Seite                          |
| `frontend/src/app/features/buch/wishlist/wishlist.component.ts` | Merkliste-Seite                          |

---

## ğŸ” Wichtige Konzepte

### 1. BehaviorSubject fÃ¼r reaktive State-Updates

```typescript
// BehaviorSubject: Observable mit initialem Wert
private cartItems$ = new BehaviorSubject<CartItem[]>([]);

// Aktuellen Wert lesen (synchron)
const current = this.cartItems$.getValue();

// Neuen Wert setzen â†’ alle Subscriber werden benachrichtigt
this.cartItems$.next(newItems);

// Als Observable fÃ¼r Components
getItems(): Observable<CartItem[]> {
    return this.cartItems$.asObservable();
}
```

### 2. localStorage API

```typescript
// Speichern (nur Strings erlaubt!)
localStorage.setItem('key', JSON.stringify(data));

// Laden
const data = JSON.parse(localStorage.getItem('key') || '[]');

// LÃ¶schen
localStorage.removeItem('key');

// Alles lÃ¶schen
localStorage.clear();
```

### 3. Toggle-Pattern fÃ¼r Merkliste

```typescript
// Template
<button (click)="toggleWishlist(buch.id)">
    {{ (isInWishlist$ | async) ? 'â¤ï¸' : 'â™¡' }}
</button>

// Component
isInWishlist$ = this.wishlistService.isInWishlist(this.buch.id);
```

---

## ğŸ—ºï¸ Architektur-Ãœbersicht

```text
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         FRONTEND                                 â”‚
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚   Detail    â”‚   â”‚    Navbar      â”‚   â”‚     Cart         â”‚   â”‚
â”‚  â”‚  Component  â”‚   â”‚   Component    â”‚   â”‚   Component      â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚         â”‚                  â”‚                      â”‚              â”‚
â”‚         â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚              â”‚
â”‚         â”‚   â”‚                             â”‚      â”‚              â”‚
â”‚         â–¼   â–¼                             â–¼      â–¼              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚              CartService / WishlistService          â”‚        â”‚
â”‚  â”‚                                                     â”‚        â”‚
â”‚  â”‚  - BehaviorSubject<CartItem[]>                      â”‚        â”‚
â”‚  â”‚  - addToCart() / removeFromCart()                   â”‚        â”‚
â”‚  â”‚  - getTotal() / getItemCount()                      â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”‚                           â”‚                                     â”‚
â”‚                           â–¼                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚                   localStorage                       â”‚        â”‚
â”‚  â”‚                                                     â”‚        â”‚
â”‚  â”‚  bookshop_cart: [{"buchId": 1, "quantity": 2}, ...] â”‚        â”‚
â”‚  â”‚  bookshop_wishlist: [1, 5, 12]                      â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”‚                                                                  â”‚
â”‚                    âŒ KEIN Backend-Call!                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”¢ Warenkorb-Berechnungen

```typescript
// cart.service.ts

// Gesamtanzahl Artikel
getItemCount(): Observable<number> {
    return this.cartItems$.pipe(
        map(items => items.reduce((sum, item) => sum + item.quantity, 0))
    );
}

// Gesamtpreis
getTotal(): Observable<number> {
    return this.cartItems$.pipe(
        map(items => items.reduce(
            (sum, item) => sum + (item.buch.preis * item.quantity),
            0
        ))
    );
}

// Preis mit Rabatt
getTotalWithDiscount(): Observable<number> {
    return this.cartItems$.pipe(
        map(items => items.reduce((sum, item) => {
            const rabatt = item.buch.rabatt || 0;
            const preis = item.buch.preis * (1 - rabatt);
            return sum + (preis * item.quantity);
        }, 0))
    );
}
```

---

## ğŸ’¡ Warum kein Backend?

| Aspekt            | BegrÃ¼ndung                           |
| ----------------- | ------------------------------------ |
| **Einfachheit**   | Kein Server-Roundtrip nÃ¶tig          |
| **Offline-fÃ¤hig** | Funktioniert ohne Internetverbindung |
| **Schnelligkeit** | Sofortige UI-Updates                 |
| **Kein Account**  | User muss nicht eingeloggt sein      |
| **Datenschutz**   | Daten bleiben beim User              |

### Nachteil

- Warenkorb ist **nicht synchron** zwischen GerÃ¤ten
- Bei LÃ¶schen von Browser-Daten â†’ Warenkorb weg

---

## Erstellungsdatum

Erstellt am 19.12.2025
